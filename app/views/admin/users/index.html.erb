<% provide :title, t("views.admin.users.title") %>
<div class="row">
  <h1><%= t "views.admin.users.all_user" %></h1>
  <div class="user-search">
    <%= search_form_for [:admin, @search], class: "form-inline" do |f| %>
      <div class="form-group">
        <%= f.label :name %>
        <%= f.text_field :name_cont, class: "form-control" %>
      </div>
      <div class="form-group">
        <%= f.label :email %>
        <%= f.text_field :email_cont, class: "form-control" %>
      </div>
      <%= button_tag(type: "submit", class: "btn btn-primary",
        name: "commit", value: "conceal") do %>
        <span class="glyphicon glyphicon-search"></span>
      <% end %>
    <% end %>
  </div>
  <table class="table table-striped table-hover table-bordered" id="admin_user">
    <thead>
      <tr class="info">
        <th><%= t "views.admin.users.index" %></th>
        <th><%= t "views.admin.users.name" %></th>
        <th><%= t "views.admin.users.email" %></th>
        <th><%= t "views.admin.users.manage" %></th>
      </tr>
    </thead>
    <tbody>
      <% @users.each_with_index do |user, index| %>
        <% unless user.supper? %>
          <tr>
            <td><%= index + 1 %></td>
            <td><%= link_to user.name, user_path(user) %></td>
            <td><%= user.email %></td>
            <% if current_user.supper? %>
              <td>
                <% if user.user? || user.role.nil? %>
                  <%= form_for [:admin, user] do |f| %>
                    <%= f.hidden_field :role, value: :admin %>
                    <%= f.submit t("views.admin.admin_action"),
                      class: "col-md-6 btn btn-success" %>
                  <% end %>
                <% end %>
                <% if user.admin? %>
                  <%= form_for [:admin, user] do |f| %>
                    <%= f.hidden_field :role, value: :user %>
                    <%= f.submit t("views.admin.user_action"),
                      class: "col-md-6 btn btn-danger" %>
                  <% end %>
                <% end %>
              </td>
            <% else %>
              <td></td>
            <% end %>
          </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
  <%= paginate @users %>
</div>
